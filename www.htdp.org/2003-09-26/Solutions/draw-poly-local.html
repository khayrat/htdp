<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Exercise 18.1.8; How to Design Programs </title>
</head>
<body>
<a href="move-pic-local.html">18.1.7</a> | <a href="../Book/curriculum-Z-H-23.html#node_thm_18.1.8">Problem Statement</a>
 | <a href="contents.html">Table of Contents</a>
 | <a href="permute-local.html">18.1.9</a><pre>
;; Language: Intermediate Student
;; Teachpack: draw.ss

#| 18.1.8 adapt figure 34
------------------------------------------------------------
;data definition:
A polygon is either
   1. (cons p empty) 
   where p is a posn, or
   2. (cons p lop) 
   where p is a posn structure and lop is a polygon.
 
;; draw-polygon : polygon  -&gt;  true
;; to draw the polygon specified by a-poly 
|#
(define (draw-polygon a-poly)
  (local [(define (draw-polygon a-poly)
            (connect-dots (cons (last a-poly) a-poly)))
          (define (connect-dots a-poly)
            (cond
              [(empty? (rest a-poly)) true]
              [else (and (draw-solid-line (first a-poly) (second a-poly) 'red)
                         (connect-dots (rest a-poly)))]))
          (define (last a-poly)
            (cond
              [(empty? (rest a-poly)) (first a-poly)] 
              [else (last (rest a-poly))]))]
    (draw-polygon a-poly)))   


(start 200 200)
(draw-polygon (cons (make-posn 10 10)
                    (cons (make-posn 60 60)
                          (cons (make-posn 10 60)
                                empty))))
</pre>
</body>
</html>
